<!doctype html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>è¶…æ…¢è·‘ç¯€æ‹å™¨</title>
<style>
  :root{ --bg:#0b0c0f; --fg:#eaeff4; --muted:#b7c2cc; --card:#161a20; --accent:#4ea1ff; --ok:#1dd1a1; --warn:#fbc531; --hot:#ff8f3c; --danger:#ff4d4f; --ring:#ffffff33}
  *{ box-sizing:border-box }
  body{ margin:0; font-family:system-ui,-apple-system,"Noto Sans TC",Segoe UI,Roboto,Helvetica,Arial,sans-serif; color:var(--fg); background:linear-gradient(145deg,#0b0c0f,#0e1116 32%,#0b0c0f); }
  .container{ max-width:1100px; margin:0 auto; padding:20px; }
  h1{ font-size:clamp(24px,4vw,36px); margin:8px 0 6px }
  .sub{ color:var(--muted); margin:0 0 16px; font-size:14px }
  .grid{ display:grid; grid-template-columns:repeat(5,minmax(140px,1fr)); gap:12px }
  @media (max-width:960px){ .grid{ grid-template-columns:repeat(3,1fr) } }
  @media (max-width:640px){ .grid{ grid-template-columns:repeat(2,1fr) } }

  /* æ‰å¹³å½©è‰²æŒ‰éˆ• */
  .card{ background:var(--card); border:1px solid #ffffff12; padding:16px; border-radius:16px; cursor:pointer; position:relative; outline: none; }
  .card:focus{ box-shadow:0 0 0 4px var(--ring) inset }
  .card.preset{ border:none; box-shadow:none; color:#0a0f14; background:var(--btn-bg,#fff2); transition:transform .06s ease, filter .12s ease, opacity .12s ease; }
  .card.preset:hover{ transform:translateY(-1px); filter:brightness(1.02) }
  .card.preset:active{ transform:translateY(0) scale(.995) }
  .tag{ font-size:12px; opacity:.9 }
  .bpm{ font-weight:900; font-size:28px; margin:2px 0 4px; letter-spacing:1px }
  .name{ font-size:14px; opacity:.95 }

  .c-blue.preset{   --btn-bg:linear-gradient(180deg, #4ea1ff 0%, #78b8ff 100%); }
  .c-green.preset{  --btn-bg:linear-gradient(180deg, #1dd1a1 0%, #4ce0b7 100%); }
  .c-yellow.preset{ --btn-bg:linear-gradient(180deg, #fbc531 0%, #ffd562 100%); }
  .c-orange.preset{ --btn-bg:linear-gradient(180deg, #ff8f3c 0%, #ffae70 100%); }
  .c-red.preset{    --btn-bg:linear-gradient(180deg, #ff4d4f 0%, #ff7a7c 100%); }

  .dot{ width:10px; height:10px; border-radius:50%; display:inline-block; vertical-align:middle; margin-right:6px; filter:contrast(1.05) }
  .dot.blue{ background:#0a5ec7 }
  .dot.green{ background:#0f8f73 }
  .dot.yellow{ background:#c79a00 }
  .dot.orange{ background:#c46814 }
  .dot.red{ background:#c12628 }

  .panel{ margin-top:16px; background:var(--card); border:1px solid #ffffff12; border-radius:20px; padding:16px }
  .row{ display:flex; flex-wrap:wrap; gap:12px; align-items:center; justify-content:space-between }
  .left,.right{ display:flex; align-items:center; gap:12px; flex-wrap:wrap }
  .pill{ padding:8px 12px; border-radius:999px; background:#ffffff10; font-size:14px }
  .btn{ border:1px solid #ffffff24; background:#ffffff08; color:var(--fg); padding:10px 14px; border-radius:12px; cursor:pointer; font-size:16px }
  .btn[disabled]{ opacity:.45; cursor:not-allowed }
  .btn.solid{ background:var(--accent); border-color:transparent; color:#001221; font-weight:700 }
  .btn.green{ background:var(--ok); color:#012018 }
  .btn.red{ background:var(--danger); color:#210103 }
  .btn.ghost{ background:transparent }
  .switch{ display:inline-flex; align-items:center; gap:8px; font-size:14px }
  .switch input{ width:44px; height:24px }
  .select{ color:black;background:#ffffff0f; border:1px solid #ffffff24; color:var(--fg); padding:8px 10px; border-radius:10px; font-size:14px }
  .hr{ height:1px; background:#ffffff12; margin:12px 0 }

  .stage{ display:grid; place-items:center; padding:24px; border-radius:16px; background:radial-gradient(1200px 400px at 50% -200px,var(--accent)15%,transparent), #0d1117; border:1px solid #ffffff10 }
  .beat{ font-size:clamp(56px,12vw,120px); font-weight:900; letter-spacing:2px; text-shadow:0 6px 24px #000a; transition:transform .1s ease }
  .ring{ width:min(420px,70vw); aspect-ratio:1; border-radius:50%; border:8px solid #ffffff14; position:relative; margin:8px auto 0; overflow:hidden }
  .fill{ position:absolute; inset:0; transform-origin:center; scale:0.1; opacity:.9; border-radius:50%; transition:transform .06s ease, background .2s ease, opacity .2s ease }

  .foot{ display:flex; flex-wrap:wrap; gap:8px; align-items:center; color:var(--muted); font-size:12px; justify-content:space-between; margin-top:8px }
  .kbd{ background:#000; border:1px solid #ffffff33; padding:2px 6px; border-radius:6px; font-family:ui-monospace,monospace }
  .hint{ color:var(--muted) }

  .hc body, .hc .panel, .hc .card{ filter:contrast(115%) }

  /* å…¨è¢å¹•å±•ç¤ºæ¨¡å¼ */
  body.showcase{ background:#0b0c0f }
  body.showcase .container{ max-width:none; padding:0 }
  body.showcase h1,
  body.showcase .sub,
  body.showcase .grid,
  body.showcase .panel .row,
  body.showcase .foot{ display:none !important }
  body.showcase .panel{ border:none; background:transparent; padding:0; border-radius:0 }
  body.showcase .stage{
    min-height:100svh; width:100%;
    border:none; border-radius:0;
    background:radial-gradient(1600px 600px at 50% -300px,var(--accent)18%,transparent), #0b0c0f;
  }
  .badge {
    font-size: 12px;
    padding: 4px 8px;
    border: 1px solid #334155;
    border-radius: 999px;
    color: var(--muted);
}
.select { 
  color-scheme: dark;
  /* ä¹Ÿå¼·åŒ–èšç„¦å¯è¦–åŒ– */
  outline: none;
}
.select:focus {
  box-shadow: 0 0 0 4px var(--ring);
  border-color: #ffffff66;
}
.select option,
.select optgroup {
  background: #0b0c0f;        /* èˆ‡é é¢ä¸€è‡´çš„æ·±è‰²èƒŒæ™¯ */
  color: #eaeff4;             /* èˆ‡ --fg ä¸€è‡´çš„å‰æ™¯è‰² */
}
.select option:checked,
.select option:focus,
.select option:hover {
  background: #4ea1ff;        /* ç”¨ä¸»é¡Œé‡é»è‰²ç•¶åç™½åº• */
  color: #001221;              /* èˆ‡ä½ çš„ .btn.solid åŒé¢¨æ ¼çš„æ·±å­—è‰² */
}
@media (forced-colors: active) {
  .select { 
    forced-color-adjust: none;
    background: Canvas;
    color: CanvasText;
    border-color: CanvasText;
  }
  .select option { 
    background: Canvas; 
    color: CanvasText; 
  }
}
.select { color: var(--fg); }
</style>
</head>
<body>
  <div class="container" id="app" tabindex="0" aria-label="è¶…æ…¢è·‘ç¯€æ‹å™¨">
    <h1>è¶…æ…¢è·‘ç¯€æ‹å™¨	<span class="badge">Developed by DennisZ</span></h1>     

    <p class="sub">é¸ä¸€å€‹ç¯€å¥é–‹å§‹ï¼šå»ºè­°ç”± 160â€“170 BPM èµ·æ­¥ï¼Œç†Ÿæ‚‰å¾Œå†æå‡ã€‚</p>


    <!-- Preset Grid -->
    <div class="grid" id="grid"></div>

    <!-- Control / Stage -->
    <div class="panel" style="margin-top:18px">
      <div class="row">
        <div class="left">
          <span class="pill" id="labelPill">å°šæœªé¸æ“‡</span>
          <span class="pill">BPMï¼š<strong id="bpmText">-</strong></span>
          <span class="pill">æ‹è™Ÿï¼š<strong id="meterText">2/4</strong></span>
          <span class="pill">é¼“å‹µæ¯ <strong id="encText">60</strong> ç§’</span>
        </div>
        <div class="right">
          <label class="switch"><input type="checkbox" id="ttsToggle" checked/>å•Ÿç”¨èªéŸ³é¼“å‹µ</label>
          <select id="voiceSel" class="select" title="é¸æ“‡èªéŸ³"></select>
          <button class="btn" id="voiceTestBtn" title="è©¦è½èªéŸ³">è©¦è½</button>
          <button class="btn solid" id="startBtn">é–‹å§‹</button>
          <button class="btn" id="pauseBtn" disabled>æš«åœ</button>
          <button class="btn red" id="stopBtn" disabled>çµæŸ</button>
        </div>
      </div>
      <div class="hr"></div>

      <div class="stage" id="stage" aria-live="polite">
        <div class="beat" id="beatText">æº–å‚™é–‹å§‹</div>
        <div class="ring"><div class="fill" id="fill"></div></div>
      </div>

      <div class="foot">
        <div>
          TV æ“ä½œï¼š
          <span class="kbd">â† â†’</span> ç¯€æ‹åˆ‡æ›ã€
          <span class="kbd">Enter</span> é–‹å§‹/æš«åœã€
          <span class="kbd">Back/Esc</span> çµæŸã€
          <span class="kbd">F</span> å…¨è¢å¹•ã€
          <span class="kbd">X</span> å±•ç¤ºæ¨¡å¼
        </div>
        <div class="hint">ç¬¬ä¸€æ¬¡æ’­æ”¾éœ€é»æ“Šã€Œé–‹å§‹ã€ä»¥å•Ÿç”¨éŸ³è¨Š</div>
      </div>
    </div>
  </div>

<script>
/** ----- Presets / Theme ----- **/
const PRESETS = [
  { id:'p160', name:'å…¥é–€', bpm:160, color:'#4ea1ff', tag:'ğŸ”µ 160ï¼ˆå…¥é–€ï¼‰', class:'blue', accentVar:'--accent' },
  { id:'p170', name:'èˆ’å£“', bpm:170, color:'#1dd1a1', tag:'ğŸŸ¢ 170ï¼ˆèˆ’å£“ï¼‰', class:'green' },
  { id:'p180', name:'æ¨™æº–', bpm:180, color:'#fbc531', tag:'ğŸŸ¡ 180ï¼ˆæ¨™æº–ï¼‰', class:'yellow' },
  { id:'p190', name:'é€²éš', bpm:190, color:'#ff8f3c', tag:'ğŸŸ  190ï¼ˆé€²éšï¼‰', class:'orange' },
  { id:'p200', name:'æŒ‘æˆ°', bpm:200, color:'#ff4d4f', tag:'ğŸ”´ 200ï¼ˆæŒ‘æˆ°ï¼‰', class:'red' },
];

// æ“´å……é¼“å‹µèªå¥ï¼ˆå¤šæ¨£åŒ–ï¼šå§¿å‹¢ã€å‘¼å¸ã€æ­¥é »ã€æ”¾é¬†ã€å°ˆæ³¨ï¼‰
const ENCOURAGE_LINES = [
  "å¾ˆå¥½ï¼Œä¿æŒè¼•é¬†æ­¥å¹…",
  "ç©©ä½ç¯€å¥ï¼Œæ”¾é¬†è‚©é ¸",
  "åšå¾—å¥½ï¼Œå°ˆæ³¨è…³ä¸‹",
  "å‘¼å¸é †æš¢ï¼Œè…³æ­¥è¼•å¿«",
  "æ”¾é¬†æ‰‹è‡‚ï¼Œæ“ºå‹•è‡ªç„¶",
  "æŠ¬é ­æŒºèƒ¸ï¼Œè¦–ç·šå‘å‰",
  "ç¶­æŒç©©å®šæ­¥é »ï¼Œä¸æ€¥ä¸èº",
  "å¸æ°£å…±å››æ‹ï¼Œåæ°£ä¹Ÿå››æ‹ï¼Œæ‰¾åˆ°ç¯€å¥",
  "èº«é«”å¾®å‘å‰å‚¾ï¼Œæ ¸å¿ƒç©©å®š",
  "æ­¥ä¼ä¸ç”¨å¤§ï¼Œç¯€å¥å„ªå…ˆ",
  "ä¿æŒç¬‘å®¹ï¼Œè®“èº«é«”æ›´æ”¾é¬†",
  "å¾ˆå¥½ï¼ŒæŒçºŒç©©ä½ç¾åœ¨çš„é€Ÿåº¦",
  "æ³¨æ„è½åœ°è¼•ï¼Œèº«é«”æ›´çœåŠ›",
  "ä½ åšå¾—å¾ˆæ£’ï¼Œç¹¼çºŒä¿æŒï¼"
];

// ä¾å¼·åº¦æä¾›ä¸åŒé¡å‹é¼“å‹µï¼ˆå°æ‡‰éœ€æ±‚ï¼šåˆ‡æ›æ™‚çµ¦å°æ‡‰é¼“å‹µï¼‰
const MODE_ENC = {
  low: [
    "ä»Šå¤©å°±ç”¨è¼•é¬†çš„ç¯€å¥æš–èº«",
    "æ…¢æ…¢ä¾†ï¼Œæ‰¾åˆ°è‡ªå·±çš„å‘¼å¸",
    "è¼•é¬†èµ°ï¼Œè®“èº«é«”å…ˆé†’ä¾†",
  ],
  mid: [
    "ç¯€å¥å‰›å¥½ï¼Œç¶­æŒç©©å®šæœ€é‡è¦",
    "å°ˆæ³¨è…³æ­¥ï¼Œè®“åŠ›é‡å¹³å‡åˆ†é…",
    "å¾ˆå¥½ï¼Œå°±ç”¨é€™å€‹é€Ÿåº¦å‰é€²",
  ],
  high: [
    "æŒ‘æˆ°é–‹å§‹ï¼Œæ³¨æ„æ”¾é¬†ä¸æ†‹æ°£",
    "ä¿æŒæ ¸å¿ƒç©©å®šï¼Œæèµ·ç²¾ç¥",
    "åŠ æ²¹ï¼ä½ æ­£åœ¨çªç ´è‡ªå·±",
  ]
};

/** ----- State / DOM ----- **/
const app = document.getElementById('app');
const grid = document.getElementById('grid');
const stage = document.getElementById('stage');
const beatText = document.getElementById('beatText');
const fill = document.getElementById('fill');
const startBtn = document.getElementById('startBtn');
const pauseBtn = document.getElementById('pauseBtn');
const stopBtn = document.getElementById('stopBtn');
const ttsToggle = document.getElementById('ttsToggle');
const labelPill = document.getElementById('labelPill');
const bpmText = document.getElementById('bpmText');
const meterText = document.getElementById('meterText');
const encText = document.getElementById('encText');
const voiceSel = document.getElementById('voiceSel');
const voiceTestBtn = document.getElementById('voiceTestBtn');

const S = {
  ctx:null, nextTime:0, playing:false,
  lookahead: 0.1, scheduleAhead: 0.5,
  bpm: 0, encSec: 60, lastEnc: 0,
  current: null, // preset object
  raf: 0,
  voices: [], voice: null
};

/** ----- å·¥å…·ï¼šæŒ‘é¸é¼“å‹µå¥ï¼ˆä¾ BPM å€é–“ï¼‰ ----- **/
function pickModeEnc(bpm){
  if(bpm < 175){
    return MODE_ENC.low[Math.floor(Math.random()*MODE_ENC.low.length)];
  } else if(bpm < 190){
    return MODE_ENC.mid[Math.floor(Math.random()*MODE_ENC.mid.length)];
  }
  return MODE_ENC.high[Math.floor(Math.random()*MODE_ENC.high.length)];
}

/** ----- UI: build cards (æ‰å¹³å½©è‰²æŒ‰éˆ•) ----- **/
function cardHTML(p){
  const borderCls = `c-${p.class} preset`;
  const dotCls = `dot ${p.class}`;
  return `
    <button class="card ${borderCls}" data-id="${p.id}" aria-label="${p.tag}">
      <div class="tag"><span class="${dotCls}"></span>${p.tag}</div>
      <div class="bpm">${p.bpm} BPM</div>
      <div class="name">${p.name}</div>
    </button>
  `;
}
grid.innerHTML = PRESETS.map(cardHTML).join('');
grid.querySelectorAll('.card').forEach(btn=>{
  btn.addEventListener('click', ()=>{
    const id = btn.getAttribute('data-id');
    const p = PRESETS.find(x=>x.id===id);
    selectPreset(p, true); // âœ… åˆ‡æ›æ™‚èªéŸ³æé†’
    startBtn.click(); // ç«‹å³é–‹å§‹
  });
});

/** ----- èªéŸ³ ----- **/
function ensureCtx(){
  if(!S.ctx){ S.ctx = new (window.AudioContext||window.webkitAudioContext)(); }
  return S.ctx;
}
function speak(text){
  if(!ttsToggle.checked) return;
  if(!('speechSynthesis' in window)) return;
  // é¿å…éšŠåˆ—å †ç©ï¼Œå…ˆæ¸…ç©ºå‰ä¸€æ¬¡å°šæœªæ’­æ”¾å®Œçš„èªéŸ³
  try{ window.speechSynthesis.cancel(); }catch(e){}
  const u = new SpeechSynthesisUtterance(text);
  if(S.voice){ u.voice = S.voice; }
  else{
    const zh = S.voices.find(v=>/^zh/i.test(v.lang));
    if(zh) u.voice = zh;
  }
  u.lang = (u.voice && u.voice.lang) ? u.voice.lang : 'zh-TW';
  u.rate = 1.0;
  window.speechSynthesis.speak(u);
}

// âœ… åˆ‡æ›æ™‚èªéŸ³æé†’ï¼ˆæ¨¡å¼ + BPM + å°æ‡‰é¼“å‹µï¼‰
function speakSwitch(p){
  const msg = `åˆ‡æ›åˆ°${p.name}æ¨¡å¼ï¼Œæ­¥ä¼æ¯åˆ†é˜${p.bpm}ä¸‹ã€‚${pickModeEnc(p.bpm)}`;
  speak(msg);
}

/** ----- Select preset / apply theme ----- **/
function selectPreset(p, announce=false){
  S.current = p;
  S.bpm = p.bpm;
  document.documentElement.style.setProperty('--accent', p.color);
  labelPill.textContent = p.tag;
  bpmText.textContent = p.bpm;
  meterText.textContent = p.bpm >= 180 ? '2/4' : '4/4';
  encText.textContent = S.encSec = p.bpm >= 190 ? 40 : (p.bpm >= 180 ? 50 : 60);
  if(announce) speakSwitch(p); // âœ… åœ¨åˆ‡æ›æ™‚æ’­å ±
}

/** ----- Audio + Scheduler ----- **/
function clickAt(t){
  const o = S.ctx.createOscillator();
  const g = S.ctx.createGain();
  o.type = 'square';
  o.frequency.value = (S.current?.bpm >= 190) ? 1100 : 880;
  g.gain.setValueAtTime(0, t);
  g.gain.linearRampToValueAtTime(0.35, t+0.001);
  g.gain.exponentialRampToValueAtTime(0.0001, t+0.03);
  o.connect(g).connect(S.ctx.destination);
  o.start(t); o.stop(t+0.05);
}
function scheduleUI(t, spb){
  const delay = Math.max(0, (t - S.ctx.currentTime) * 1000);
  setTimeout(()=>{
    beatText.textContent = 'â—';
    beatText.style.transform = 'scale(1.06)';
    setTimeout(()=>{ beatText.textContent = 'â—‹'; beatText.style.transform = 'scale(1.0)'; }, 80);

    fill.style.background = getComputedStyle(document.documentElement).getPropertyValue('--accent');
    fill.style.transform = 'scale(1.0)';
    fill.style.opacity = .95;
    setTimeout(()=>{ fill.style.transform = 'scale(0.1)'; fill.style.opacity = .6; }, spb*900);
  }, delay);
}
function scheduler(){
  if(!S.ctx) return;
  const spb = 60.0 / S.bpm;
  while(S.nextTime < S.ctx.currentTime + S.scheduleAhead){
    clickAt(S.nextTime);
    scheduleUI(S.nextTime, spb);
    S.nextTime += spb;
  }
  const now = S.ctx.currentTime;
  if(now - S.lastEnc > S.encSec){
    S.lastEnc = now;
    // ç·´ç¿’é€²è¡Œä¸­çš„é¼“å‹µä½¿ç”¨ä¸€èˆ¬æ± ï¼ˆé¿å…æ¯æ¬¡éƒ½æ’­å ±æ¨¡å¼ï¼‰
    speak(ENCOURAGE_LINES[Math.floor(Math.random()*ENCOURAGE_LINES.length)]);
  }
  S.raf = setTimeout(scheduler, S.lookahead*1000);
}

/** ----- Controls ----- **/
startBtn.addEventListener('click', async ()=>{
  if(!S.current) selectPreset(PRESETS[0]);
  ensureCtx();
  await S.ctx.resume();
  if(S.playing) return;
  S.playing = true;
  S.lastEnc = S.ctx.currentTime;
  S.nextTime = S.ctx.currentTime + 0.25;
  startBtn.disabled = true; pauseBtn.disabled = false; stopBtn.disabled = false;
  speak("é–‹å§‹å›‰ï¼Œè¼•é¬†è¸æ­¥");
  scheduler();
});
pauseBtn.addEventListener('click', async ()=>{
  if(!S.playing || !S.ctx) return;
  S.playing = false;
  clearTimeout(S.raf);
  await S.ctx.suspend();
  startBtn.disabled = false; pauseBtn.disabled = true;
  speak("æš«åœä¸€ä¸‹ï¼Œèª¿æ•´å‘¼å¸");
});
stopBtn.addEventListener('click', async ()=>{
  if(!S.ctx) return;
  S.playing = false;
  clearTimeout(S.raf);
  await S.ctx.close(); S.ctx = null;
  startBtn.disabled = false; pauseBtn.disabled = true; stopBtn.disabled = true;
  beatText.textContent = "å®Œæˆï¼åšå¾—å¾ˆå¥½";
  fill.style.transform = 'scale(0.1)';
});

/** ----- èªéŸ³é¸æ“‡ï¼ˆSpeechSynthesis voicesï¼‰ ----- **/
function populateVoices(){
  S.voices = window.speechSynthesis.getVoices?.() || [];
  const preferZh = S.voices.filter(v=>/^zh/i.test(v.lang));
  const list = preferZh.length ? preferZh : S.voices;
  const saved = localStorage.getItem('metronome.voiceURI');
  voiceSel.innerHTML = '';
  list.forEach(v=>{
    const opt = document.createElement('option');
    opt.value = v.voiceURI;
    opt.textContent = `${v.name} â€” ${v.lang}${v.default ? 'ï¼ˆé è¨­ï¼‰' : ''}`;
    voiceSel.appendChild(opt);
  });
  if(!list.length){
    const opt = document.createElement('option');
    opt.value = '';
    opt.textContent = 'ï¼ˆæ‰¾ä¸åˆ°å¯ç”¨èªéŸ³ï¼‰';
    voiceSel.appendChild(opt);
    voiceSel.disabled = true;
  }else{
    if(saved){
      const v = S.voices.find(x=>x.voiceURI===saved);
      if(v){ S.voice = v; voiceSel.value = saved; }
    }else{
      S.voice = list[0];
      voiceSel.value = list[0].voiceURI;
    }
    voiceSel.disabled = false;
  }
}
if('speechSynthesis' in window){
  window.speechSynthesis.onvoiceschanged = populateVoices;
  setTimeout(populateVoices, 200);
}
voiceSel.addEventListener('change', ()=>{
  const uri = voiceSel.value;
  const v = S.voices.find(x=>x.voiceURI===uri);
  S.voice = v || null;
  localStorage.setItem('metronome.voiceURI', uri || '');
});
voiceTestBtn.addEventListener('click', ()=>{
  speak("é€™æ˜¯è©¦è½ã€‚ä¿æŒç©©å®šç¯€å¥ï¼Œæº–å‚™é–‹å§‹ã€‚");
});

/** ----- Fullscreen / Showcase ----- **/
function toggleFullscreen(){
  if(!document.fullscreenElement){
    (app.requestFullscreen ? app.requestFullscreen({navigationUI:'hide'}) : document.documentElement.requestFullscreen?.());
  }else{
    document.exitFullscreen?.();
  }
}
function toggleShowcase(){
  document.body.classList.toggle('showcase');
}

/** ----- Keyboard (TV Friendly + F / X) ----- **/
app.addEventListener('keydown', (e)=>{
  const idx = S.current ? PRESETS.findIndex(x=>x.id===S.current.id) : 0;
  if(e.key==='ArrowRight'){
    const n = PRESETS[Math.min(PRESETS.length-1, idx+1)];
    selectPreset(n, true); // âœ… åˆ‡æ›æ™‚èªéŸ³æé†’
    if(S.playing){ /* smooth apply */ }
  }
  if(e.key==='ArrowLeft'){
    const n = PRESETS[Math.max(0, idx-1)];
    selectPreset(n, true); // âœ… åˆ‡æ›æ™‚èªéŸ³æé†’
    if(S.playing){ /* smooth apply */ }
  }
  if(e.key==='Enter'){ if(!S.playing) startBtn.click(); else pauseBtn.click(); }
  if(e.key==='Backspace' || e.key==='Escape'){ stopBtn.click(); }
  if(e.key==='f' || e.key==='F'){ e.preventDefault(); toggleFullscreen(); }
  if(e.key==='x' || e.key==='X'){ e.preventDefault(); toggleShowcase();}
});
app.focus();

/** ----- Default Select ----- **/
selectPreset(PRESETS[0]); // åˆæ¬¡è¼‰å…¥ä¸æ’­å ±ï¼Œç­‰ä½¿ç”¨è€…åˆ‡æ›æ™‚æ‰æ’­å ±
</script>
</body>
</html>